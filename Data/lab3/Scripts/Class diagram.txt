@startuml
title Domain Model â€” Fiction Semantic Analyzer

class Manuscript {
  +id: UUID
  +title: string
  +author: string
  +language: string
  +sourceUri: string
  +uploadedBy: UserId
}

class Scene {
  +id: UUID
  +manuscriptId: UUID
  +index: int
  +text: Text
  +sentimentScore: float
}

class Character {
  +id: UUID
  +name: string
  +aliases: string[]
}

class Quote {
  +id: UUID
  +sceneId: UUID
  +speakerId: UUID
  +text: Text
}

class Topic {
  +id: UUID
  +label: string
  +coherence: float
}

class SceneTopic {
  +sceneId: UUID
  +topicId: UUID
  +weight: float
}

class Entity {
  +id: UUID
  +sceneId: UUID
  +type: enum {PERSON, LOC, ORG, MISC}
  +text: string
  +start: int
  +end: int
}

class CharacterEdge {
  +id: UUID
  +sourceCharacterId: UUID
  +targetCharacterId: UUID
  +weight: float
  +relation: string
}

class StyleSuggestion {
  +id: UUID
  +sceneId: UUID
  +provider: string  // "Grammarly"
  +category: string  // clarity, conciseness, tone
  +message: string
  +offsetStart: int
  +offsetEnd: int
}

class AnalysisRun {
  +id: UUID
  +manuscriptId: UUID
  +status: enum {QUEUED,RUNNING,COMPLETED,FAILED}
  +startedAt: datetime
  +finishedAt: datetime
}

class Summary {
  +id: UUID
  +manuscriptId: UUID
  +provider: string // "LLM"
  +text: Text
  +sections: json
}

Manuscript "1" -- "many" Scene
Manuscript "1" -- "many" AnalysisRun
Scene "1" -- "many" Quote
Scene "1" -- "many" Entity
Scene "1" -- "many" SceneTopic
Topic "1" -- "many" SceneTopic
Character "1" -- "many" Quote : speaker
Character "1" -- "many" CharacterEdge : as source
Character "1" -- "many" CharacterEdge : as target
Scene "1" -- "many" StyleSuggestion
Manuscript "1" -- "0..1" Summary
@enduml
